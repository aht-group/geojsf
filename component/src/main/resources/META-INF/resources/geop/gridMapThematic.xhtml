<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml"
   	xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:geojsf="http://geojsf.org/ui"
    xmlns:geop="http://geojsf.org/prototype"
    xmlns:aht="http://ahtutils.sourceforge.net/jsf"
    xmlns:aup="http://ahtutils.sourceforge.net/prototype"
    xmlns:composite="http://java.sun.com/jsf/composite">
    
	<composite:interface>
		<composite:attribute name="bean" required="false" default="#{adminMapThematicBean}"/>
		
		<composite:facet name="map" required="true"/>
	</composite:interface>
        
	<composite:implementation>
		<aup:grid>
	<aht:row>
		<aht:slot>
			<p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />
		</aht:slot>
	</aht:row>
	<aht:row id="rowMaps">
		<aht:slot width="2">
			<h:form id="fMaps">
				<geop:adminMapsMapTable bean="#{cc.attrs.bean}" update=":#{cc.id}:rowMaps"/>
			</h:form>
		</aht:slot>
		<aht:slot id="sMap" width="4">
			<h:form id="fMap">
				<geop:adminMapsMapPanel bean="#{cc.attrs.bean}" update=":#{cc.id}:rowMaps"/>
			</h:form>
			<h:form id="fLayers">
				<geop:adminMapsLayerTable bean="#{cc.attrs.bean}" update=":#{cc.id}:fView" updateMap=":#{cc.id}:fGeoJsfMap"/>
			</h:form>
		</aht:slot>
		<aht:slot id="sView" width="6">
			<h:form id="fGeoJsfMap">
				<p:panel header="#{cc.attrs.bean.map.name[userBean.localeCode].lang}" styleClass="geojsfPrimefacesPanelMap" 
							rendered="#{(not empty cc.attrs.bean.map) and (cc.attrs.bean.map.id gt 0) and (fn:length(cc.attrs.bean.map.views) gt 0)}">
					<f:facet name="actions">
						<aht:icon type="geoJsfSave" listener="#{cc.attrs.bean.saveViewPort()}"/>
					</f:facet>
					<geojsf:map id="map" baseMap="osm" value="#{cc.attrs.bean.map}">
						<composite:renderFacet name="map"/>
						<geojsf:viewport value="#{cc.attrs.bean.map.viewPort}"/>
						<p:ajax event="mapMove" update="@form" listener="#{cc.attrs.bean.mapMove}"/>
					</geojsf:map>
				</p:panel>
			</h:form>
			<h:form id="fView">
				<geop:adminMapsViewPanel update=":#{cc.id}:fLayers :#{cc.id}:fView"/>
			</h:form>
		</aht:slot>
	</aht:row>
</aup:grid>
	</composite:implementation>
</html>