<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:composite="http://java.sun.com/jsf/composite">
    
   <composite:interface>
     <composite:attribute name="title"/>
     <composite:attribute name="clientId"/>
     <composite:attribute name="imagePath"/>
     <composite:attribute name="serviceName" default="OpenLayers WMS"/>
     <composite:attribute name="layerOptions" default="{layers: 'basic', format: 'image/png'}"/>
     <composite:attribute name="mapOptions" default=" { controls: [new OpenLayers.Control.MousePosition()] }"/>
     <composite:attribute name="serviceURL" default="http://vmap0.tiles.osgeo.org/wms/vmap0"/>
     <composite:attribute name="centerX" default="0.0"/>
     <composite:attribute name="centerY" default="0.0"/>
     <composite:attribute name="zoomLevel" default="5"/>
     <composite:attribute name="moverview"/>
     <composite:attribute name="moverviewx" default="149"/>
     <composite:attribute name="moverviewy" default="149"/>
     <composite:attribute name="width" default="100%"/>
     <composite:attribute name="height" default="400"/>
     <composite:clientBehavior name="mapclick" 
                              event="mapclick"
                            targets="#{cc.clientId}"/>
   </composite:interface>
        
  <composite:implementation>
   	 <script src="http://openlayers.org/api/OpenLayers.js"/>
   	 <h:outputScript library="geojsf"     name="MapInitAPI.js"/>
     <h:outputScript library="geojsf"     name="scalebar.js"/>
     <h:outputStylesheet library="geojsf" name="scalebar-thin.css"/>   
     <h:outputStylesheet library="geojsf" name="geojsf.css"/>
     
     
     <div id="#{cc.attrs.clientId}" style="padding: 0; width:#{cc.attrs.width};height:#{cc.attrs.height}px" />
     <c:if test="#{!empty cc.attrs.moverview}">
	 	<div id="#{cc.attrs.moverview}" style="width:#{cc.attrs.moverviewy}px;height:#{cc.attrs.moverviewx}px" />
	 </c:if>
	 <c:choose>
	 <c:when test="#{!empty initParam['geojsf.THEME']}">
	 	<h:outputScript>
        var mloptions = #{cc.attrs.layerOptions};
        var mcoptions = #{cc.attrs.mapOptions};
         function __initOL() {
        	__addClickHandler();
        	OpenLayers.ImgPath='#{facesContext.externalContext.requestContextPath}/#{initParam['geojsf.THEME']}/';
            __initMapDiv("#{cc.attrs.clientId}",mcoptions);
            __initMapLayers("#{cc.attrs.serviceName}","#{cc.attrs.serviceURL}","#{cc.attrs.centerX}","#{cc.attrs.centerY}","#{cc.attrs.zoomLevel}",mloptions);
            }
        __addLoadEvent( __initOL);     
     </h:outputScript>
	 </c:when>
	 <c:otherwise>
	 <h:outputScript>
        var mloptions = #{cc.attrs.layerOptions};
        var mcoptions = #{cc.attrs.mapOptions};
         function __initOL() {
        	__addClickHandler();
            __initMapDiv("#{cc.attrs.clientId}",mcoptions);
            __initMapLayers("#{cc.attrs.serviceName}","#{cc.attrs.serviceURL}","#{cc.attrs.centerX}","#{cc.attrs.centerY}","#{cc.attrs.zoomLevel}",mloptions);
            }
        __addLoadEvent( __initOL);     
     </h:outputScript>
	 </c:otherwise>
	 </c:choose>
     
   </composite:implementation>
</html>